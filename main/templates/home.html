{% extends "base.html" %}
{% load static %}

{% block title %}
<title>FCSIT Survey App - Home</title>
{% endblock %}

{% block css %}
<link rel='stylesheet' type="text/css" href="{% static 'css/home.css' %}">
{% endblock %}

{% block header_container %}
<div class="position-relative overflow-hidden m-md-3 text-center bg-light">
    <div class="row justify-content-center">
        <div class="col-md-6 p-lg-9 my-5">
            <h1 class="display-4 font-weight-normal">FCSIT Survey App</h1>
            <div class="col-md-20 mx-auto">
                <p class="lead font-weight-normal">This is a simple web application built to <b>compile all FCSIT survey
                        forms</b> for faculty courses.</p>
                <br>
                <p class="lead font-weight-normal"><b>For usage of FCSIT UM students only.</b></p>
            </div>
            <a class="btn btn-primary" data-toggle="modal" data-target="#survey-form">Add My Survey</a>
        </div>

        <img src="{% static 'img/landing_bg.svg' %}"
            style="width: 330px; vertical-align: middle; margin-left: 0px; margin-right: 0px; margin-top: 1.5rem!important; margin-bottom: 1.5rem!important">

    </div>

</div>
{% endblock %}

{% block content_container %}
<div class="position-relative overflow-hidden p-3 p-md-5 m-md-3 bg-light" id="main-container">

    <div class="row justify-content-center" style="flex-wrap: nowrap">

        <div class="col-auto">
            <div class="nav flex-column nav-pills" style="text-align: center;" id="v-pills-tab" role="tablist"
                aria-orientation="vertical">
                {% for year in year_list %}
                {% if year.year == 1 %}
                <a class="nav-link active" id="{{ year.year }}-tab" data-toggle="tab" href="#y{{ year.year }}" role="tab"
                    aria-controls="y{{ year.year }}" aria-selected="true">{{ year.label }}</a>
                {% else %}
                <a class="nav-link" id="{{ year.year }}-tab" data-toggle="tab" href="#y{{ year.year }}" role="tab"
                    aria-controls="y{{ year.year }}" aria-selected="false">{{ year.label }}</a>
                {% endif %}
                {% endfor %}
            </div>
        </div>

        <div class="col-9">
            {% if messages %}
            {% for message in messages %}
            {% if message.tags == 'error' %}
            <div style="font-size: 100%; display:inline-block; margin-bottom: 1rem;" class="alert alert-danger"
                role="alert">
                {{ message }}</div>
            {% elif message.tags == 'success'%}
            <div style="font-size: 100%; display:inline-block; margin-bottom: 1rem;" class="alert alert-success"
                role="alert">
                {{ message }}</div>
            {% endif %}
            {% endfor %}
            {% endif %}
            <div class="tab-content">

                <div class="tab-pane fade show active" id="y1" role="tabpanel" aria-labelledby="y1-tab">
                    <h5>Here are the list of surveys for Year 1 faculty courses:</h5>

                    <ul class="nav nav-tabs">
                        {% for course in y1_course_list %}
                        {% if course.year.year == 1 and forloop.first %}
                        <li class="nav-item" data-toggle="tooltip" data-placement="top" title="{{ course.name }}">
                            <a class="nav-link active" data-toggle="tab" href="#y1-{{ course.code }}">{{ course.code }}</a>
                        </li>
                        {% elif course.year.year == 1 %}
                        <li class="nav-item" data-toggle="tooltip" data-placement="top" title="{{ course.name }}">
                            <a class="nav-link" data-toggle="tab" href="#y1-{{ course.code }}">{{ course.code }}</a>
                        </li>
                        <!-- <li class="nav-item">
                            <a class="nav-link" data-toggle="tab" href="#y1-c2">Course 1-2</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" data-toggle="tab" href="#y1-c3">Course 1-3</a>
                        </li> -->
                        {% endif %}
                        {% endfor %}
                    </ul>

                    <div class="tab-content" style="margin-bottom:50px">
                        {% for course in y1_course_list %}
                        {% if forloop.first %}

                        <div class="tab-pane fade show active" id="y1-{{ course.code }}">
                            <br>
                            <h5>{{ course.name }}</h5>
                            <br>

                            <!-- Search form -->
                            <div class="form-group">
                                <div class="row">
                                    <div class="col-md-4">
                                        <input class="form-control accordion_search_bar" id="{{ course.code }}"
                                            type="search" placeholder="Search title, description or PIC name"
                                            aria-label="Search">
                                    </div>
                                    <div class="col"></div>
                                </div>
                            </div>

                            <div id="accordion-{{ course.code }}" class="accordion">

                                {% for survey in survey_list %}

                                {% if survey.year.year == 1 and survey.course_code.code == course.code and survey.approved == True and survey.expiry_date != current_date %}
                                <div class="card {{ course.code }}" id="{{ survey.id }}">
                                    <div class="card-header">
                                        <div class="row justify-content-between">
                                            <div class="col-md-6">
                                                <h6 class="mb-0" style="cursor: pointer;" data-toggle="collapse"
                                                    data-target="#collapse{{ survey.id }}" aria-expanded="true"
                                                    aria-controls="collapse{{ survey.id }}">

                                                    <span class="survey_title">{{ survey.title }}</span>
                                                    <small class="form-text text-muted">Due on
                                                        {{ survey.expiry_date }}</small>

                                                </h6>
                                            </div>

                                            <div class="col-auto my-auto">
                                                <a target="_blank" href="{{ survey.link }}">Survey Link</a>
                                            </div>

                                            <div class="col-auto my-auto">
                                                <div class="dropdown">
                                                    <a role="button" id="dropdownMenuLink" data-toggle="dropdown"
                                                        aria-haspopup="true" aria-expanded="false">
                                                        <i class="fas fa-ellipsis-h"></i>
                                                    </a>
                                                    <div class="dropdown-menu justify-content-center"
                                                        aria-labelledby="dropdownMenuLink">
                                                        <form method="POST" action="{% url 'whatsapp_api' %}"
                                                            target="_blank">
                                                            {% csrf_token %}
                                                            <input type="hidden" name="survey_link"
                                                                value="{{ survey.link }}">
                                                            <input type="hidden" name="title" value="{{ survey.title }}">
                                                            <input type="hidden" name="description"
                                                                value="{{ survey.description }}">
                                                            <a style="cursor: pointer" class="dropdown-item"
                                                                onclick="this.closest('form').submit();return false;">Share
                                                                to <i class="fab fa-whatsapp fa-lg"></i></a>
                                                        </form>

                                                        <form method="POST" action="{% url 'twitter_api' %}"
                                                            target="_blank">
                                                            {% csrf_token %}
                                                            <input type="hidden" name="survey_link"
                                                                value="{{ survey.link }}">
                                                            <input type="hidden" name="title" value="{{ survey.title }}">
                                                            <input type="hidden" name="description"
                                                                value="{{ survey.description }}">
                                                            <a style="cursor: pointer" class="dropdown-item"
                                                                onclick="this.closest('form').submit();return false;">Share
                                                                to <i class="fab fa-twitter"></i></a>
                                                        </form>

                                                        {% for desc in description_filtered %}
                                                        {% if survey.id == desc.id %}
                                                        <a class="dropdown-item"
                                                            href="
                                                            mailto:student_info-list@siswa.um.edu.my,fsktm_student-list@um.edu.my?subject={{ survey.title }}&body={{ desc.description }}%0D%0A%0ALink: {{ survey.link }}">Share
                                                            to
                                                            <i class="far fa-envelope fa-lg"></i></a>
                                                        {% endif %}
                                                        {% endfor %}

                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                    </div>

                                    <div id="collapse{{ survey.id }}" class="collapse"
                                        aria-labelledby="heading{{ survey.id }}" data-parent="#accordion-{{ course.code }}">
                                        <div class="card-body" id="survey-description-main">
                                            <div class="form-row">
                                                <div class="form-group col-md-6">
                                                    <label>PIC Name</label>
                                                    <input type="text" class="form-control PIC_name"
                                                        value="{{ survey.PIC_name }}" style="background-color: white; color: #212529;"
                                                        disabled>
                                                </div>
                                                <div class="form-group col-md-6">
                                                    <label>PIC Email</label>
                                                    <input type="text" class="form-control" value="{{ survey.PIC_email }}"
                                                        style="background-color: white; color: #212529;" disabled>
                                                </div>
                                            </div>

                                            <label>Description</label>
                                            <textarea class="summernote" name="description" rows="7"
                                                placeholder="Enter description" required
                                                readonly>{{ survey.description }}</textarea>
                                            <!-- {{ survey.description }} -->
                                        </div>
                                    </div>
                                </div>
                                {% endif %}
                                {% endfor %}

                            </div>
                        </div>
                        {% else %}
                        <div class="tab-pane fade" id="y1-{{ course.code }}">
                            <br>
                            <h5>{{ course.name }}</h5>
                            <br>

                            <!-- Search form -->
                            <div class="form-group">
                                <div class="row">
                                    <div class="col-md-4">
                                        <input class="form-control accordion_search_bar" id="{{ course.code }}"
                                            type="search" placeholder="Search title, description or PIC name"
                                            aria-label="Search">
                                    </div>
                                    <div class="col"></div>
                                </div>
                            </div>

                            <div id="accordion-{{ course.code }}" class="accordion">

                                {% for survey in survey_list %}
                                {% if survey.year.year == 1 and survey.course_code.code == course.code and survey.approved == True and survey.expiry_date != current_date %}
                                <div class="card {{ course.code }}" id="{{ survey.id }}">
                                    <div class="card-header">
                                        <div class="row justify-content-between">
                                            <div class="col-md-6">
                                                <h6 class="mb-0" style="cursor: pointer;" data-toggle="collapse"
                                                    data-target="#collapse{{ survey.id }}" aria-expanded="true"
                                                    aria-controls="collapse{{ survey.id }}">

                                                    <span class="survey_title">{{ survey.title }}</span>
                                                    <small class="form-text text-muted">Due on
                                                        {{ survey.expiry_date }}</small>

                                                </h6>
                                            </div>

                                            <div class="col-auto my-auto">
                                                <a target="_blank" href="{{ survey.link }}">Survey Link</a>
                                            </div>
                                            <div class="col-auto my-auto">
                                                <div class="dropdown">
                                                    <a role="button" id="dropdownMenuLink" data-toggle="dropdown"
                                                        aria-haspopup="true" aria-expanded="false">
                                                        <i class="fas fa-ellipsis-h"></i>
                                                    </a>
                                                    <div class="dropdown-menu justify-content-center"
                                                        aria-labelledby="dropdownMenuLink">
                                                        <form method="POST" action="{% url 'whatsapp_api' %}"
                                                            target="_blank">
                                                            {% csrf_token %}
                                                            <input type="hidden" name="survey_link"
                                                                value="{{ survey.link }}">
                                                            <input type="hidden" name="title" value="{{ survey.title }}">
                                                            <input type="hidden" name="description"
                                                                value="{{ survey.description }}">
                                                            <a style="cursor: pointer" class="dropdown-item"
                                                                onclick="this.closest('form').submit();return false;">Share
                                                                to <i class="fab fa-whatsapp fa-lg"></i></a>
                                                        </form>

                                                        <form method="POST" action="{% url 'twitter_api' %}"
                                                            target="_blank">
                                                            {% csrf_token %}
                                                            <input type="hidden" name="survey_link"
                                                                value="{{ survey.link }}">
                                                            <input type="hidden" name="title" value="{{ survey.title }}">
                                                            <input type="hidden" name="description"
                                                                value="{{ survey.description }}">
                                                            <a style="cursor: pointer" class="dropdown-item"
                                                                onclick="this.closest('form').submit();return false;">Share
                                                                to <i class="fab fa-twitter"></i></a>
                                                        </form>

                                                        {% for desc in description_filtered %}
                                                        {% if survey.id == desc.id %}
                                                        <a class="dropdown-item"
                                                            href="
                                                            mailto:student_info-list@siswa.um.edu.my,fsktm_student-list@um.edu.my?subject={{ survey.title }}&body={{ desc.description }}%0D%0A%0ALink: {{ survey.link }}">Share
                                                            to
                                                            <i class="far fa-envelope fa-lg"></i></a>
                                                        {% endif %}
                                                        {% endfor %}
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                    </div>

                                    <div id="collapse{{ survey.id }}" class="collapse"
                                        aria-labelledby="heading{{ survey.id }}" data-parent="#accordion-{{ course.code }}">
                                        <div class="card-body" id="survey-description-main">
                                            <div class="form-row">
                                                <div class="form-group col-md-6">
                                                    <label>PIC Name</label>
                                                    <input type="text" class="form-control PIC_name"
                                                        value="{{ survey.PIC_name }}" style="background-color: white; color: #212529;"
                                                        disabled>
                                                </div>
                                                <div class="form-group col-md-6">
                                                    <label>PIC Email</label>
                                                    <input type="text" class="form-control" value="{{ survey.PIC_email }}"
                                                        style="background-color: white; color: #212529;" disabled>
                                                </div>
                                            </div>

                                            <label>Description</label>
                                            <textarea class="summernote" name="description" rows="7"
                                                placeholder="Enter description" required
                                                readonly>{{ survey.description }}</textarea>
                                            <!-- {{ survey.description }} -->
                                        </div>
                                    </div>
                                </div>
                                {% endif %}
                                {% endfor %}

                            </div>
                        </div>
                        {% endif %}
                        {% endfor %}

                        <!-- <div class="tab-pane fade" id="y1-c2">This is the content for subtab 1.2.</div>
                        <div class="tab-pane fade" id="y1-c3">This is the content for subtab 1.3.</div> -->
                    </div>

                </div>

                <div class="tab-pane fade" id="y2" role="tabpanel" aria-labelledby="y2-tab">
                    <h5>Here are the list of surveys for Year 2 faculty courses:</h5>

                    <ul class="nav nav-tabs">
                        {% for course in y2_course_list %}
                        {% if course.year.year == 2 and forloop.first %}
                        <li class="nav-item" data-toggle="tooltip" data-placement="top" title="{{ course.name }}">
                            <a class="nav-link active" data-toggle="tab" href="#y2-{{ course.code }}">{{ course.code }}</a>
                        </li>
                        {% elif course.year.year == 2 %}
                        <li class="nav-item" data-toggle="tooltip" data-placement="top" title="{{ course.name }}">
                            <a class="nav-link" data-toggle="tab" href="#y2-{{ course.code }}">{{ course.code }}</a>
                        </li>
                        <!-- <li class="nav-item">
                            <a class="nav-link" data-toggle="tab" href="#y1-c2">Course 1-2</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" data-toggle="tab" href="#y1-c3">Course 1-3</a>
                        </li> -->
                        {% endif %}
                        {% endfor %}
                    </ul>

                    <div class="tab-content" style="margin-bottom:50px">
                        {% for course in y2_course_list %}
                        {% if forloop.first %}
                        <div class="tab-pane fade show active" id="y2-{{ course.code }}">
                            <br>
                            <h5>{{ course.name }}</h5>
                            <br>

                            <!-- Search form -->
                            <div class="form-group">
                                <div class="row">
                                    <div class="col-md-4">
                                        <input class="form-control accordion_search_bar" id="{{ course.code }}"
                                            type="search" placeholder="Search title, description or PIC name"
                                            aria-label="Search">
                                    </div>
                                    <div class="col"></div>
                                </div>
                            </div>

                            <div id="accordion-{{ course.code }}" class="accordion">

                                {% for survey in survey_list %}
                                {% if survey.year.year == 2 and survey.course_code.code == course.code and survey.approved == True and survey.expiry_date != current_date %}
                                <div class="card {{ course.code }}" id="{{ survey.id }}">
                                    <div class="card-header">
                                        <div class="row justify-content-between">
                                            <div class="col-md-6">
                                                <h6 class="mb-0" style="cursor: pointer;" data-toggle="collapse"
                                                    data-target="#collapse{{ survey.id }}" aria-expanded="true"
                                                    aria-controls="collapse{{ survey.id }}">

                                                    <span class="survey_title">{{ survey.title }}</span>
                                                    <small class="form-text text-muted">Due on
                                                        {{ survey.expiry_date }}</small>

                                                </h6>
                                            </div>

                                            <div class="col-auto my-auto">
                                                <a target="_blank" href="{{ survey.link }}">Survey Link</a>
                                            </div>
                                            <div class="col-auto my-auto">
                                                <div class="dropdown">
                                                    <a role="button" id="dropdownMenuLink" data-toggle="dropdown"
                                                        aria-haspopup="true" aria-expanded="false">
                                                        <i class="fas fa-ellipsis-h"></i>
                                                    </a>
                                                    <div class="dropdown-menu justify-content-center"
                                                        aria-labelledby="dropdownMenuLink">
                                                        <form method="POST" action="{% url 'whatsapp_api' %}"
                                                            target="_blank">
                                                            {% csrf_token %}
                                                            <input type="hidden" name="survey_link"
                                                                value="{{ survey.link }}">
                                                            <input type="hidden" name="title" value="{{ survey.title }}">
                                                            <input type="hidden" name="description"
                                                                value="{{ survey.description }}">
                                                            <a style="cursor: pointer" class="dropdown-item"
                                                                onclick="this.closest('form').submit();return false;">Share
                                                                to <i class="fab fa-whatsapp fa-lg"></i></a>
                                                        </form>

                                                        <form method="POST" action="{% url 'twitter_api' %}"
                                                            target="_blank">
                                                            {% csrf_token %}
                                                            <input type="hidden" name="survey_link"
                                                                value="{{ survey.link }}">
                                                            <input type="hidden" name="title" value="{{ survey.title }}">
                                                            <input type="hidden" name="description"
                                                                value="{{ survey.description }}">
                                                            <a style="cursor: pointer" class="dropdown-item"
                                                                onclick="this.closest('form').submit();return false;">Share
                                                                to <i class="fab fa-twitter"></i></a>
                                                        </form>

                                                        {% for desc in description_filtered %}
                                                        {% if survey.id == desc.id %}
                                                        <a class="dropdown-item"
                                                            href="
                                                            mailto:student_info-list@siswa.um.edu.my,fsktm_student-list@um.edu.my?subject={{ survey.title }}&body={{ desc.description }}%0D%0A%0ALink: {{ survey.link }}">Share
                                                            to
                                                            <i class="far fa-envelope fa-lg"></i></a>
                                                        {% endif %}
                                                        {% endfor %}
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                    </div>

                                    <div id="collapse{{ survey.id }}" class="collapse"
                                        aria-labelledby="heading{{ survey.id }}" data-parent="#accordion-{{ course.code }}">
                                        <div class="card-body" id="survey-description-main">
                                            <div class="form-row">
                                                <div class="form-group col-md-6">
                                                    <label>PIC Name</label>
                                                    <input type="text" class="form-control PIC_name"
                                                        value="{{ survey.PIC_name }}" style="background-color: white; color: #212529;"
                                                        disabled>
                                                </div>
                                                <div class="form-group col-md-6">
                                                    <label>PIC Email</label>
                                                    <input type="text" class="form-control" value="{{ survey.PIC_email }}"
                                                        style="background-color: white; color: #212529;" disabled>
                                                </div>
                                            </div>

                                            <label>Description</label>
                                            <textarea class="summernote" name="description" rows="7"
                                                placeholder="Enter description" required
                                                readonly>{{ survey.description }}</textarea>
                                            <!-- {{ survey.description }} -->
                                        </div>
                                    </div>
                                </div>
                                {% endif %}
                                {% endfor %}

                            </div>
                        </div>
                        {% else %}
                        <div class="tab-pane fade" id="y2-{{ course.code }}">
                            <br>
                            <h5>{{ course.name }}</h5>
                            <br>

                            <!-- Search form -->
                            <div class="form-group">
                                <div class="row">
                                    <div class="col-md-4">
                                        <input class="form-control accordion_search_bar" id="{{ course.code }}"
                                            type="search" placeholder="Search title, description or PIC name"
                                            aria-label="Search">
                                    </div>
                                    <div class="col"></div>
                                </div>
                            </div>

                            <div id="accordion-{{ course.code }}" class="accordion">

                                {% for survey in survey_list %}
                                {% if survey.year.year == 2 and survey.course_code.code == course.code and survey.approved == True and survey.expiry_date != current_date %}
                                <div class="card {{ course.code }}" id="{{ survey.id }}">
                                    <div class="card-header">
                                        <div class="row justify-content-between">
                                            <div class="col-md-6">
                                                <h6 class="mb-0" style="cursor: pointer;" data-toggle="collapse"
                                                    data-target="#collapse{{ survey.id }}" aria-expanded="true"
                                                    aria-controls="collapse{{ survey.id }}">

                                                    <span class="survey_title">{{ survey.title }}</span>
                                                    <small class="form-text text-muted">Due on
                                                        {{ survey.expiry_date }}</small>

                                                </h6>
                                            </div>

                                            <div class="col-auto my-auto">
                                                <a target="_blank" href="{{ survey.link }}">Survey Link</a>
                                            </div>
                                            <div class="col-auto my-auto">
                                                <div class="dropdown">
                                                    <a role="button" id="dropdownMenuLink" data-toggle="dropdown"
                                                        aria-haspopup="true" aria-expanded="false">
                                                        <i class="fas fa-ellipsis-h"></i>
                                                    </a>
                                                    <div class="dropdown-menu justify-content-center"
                                                        aria-labelledby="dropdownMenuLink">
                                                        <form method="POST" action="{% url 'whatsapp_api' %}"
                                                            target="_blank">
                                                            {% csrf_token %}
                                                            <input type="hidden" name="survey_link"
                                                                value="{{ survey.link }}">
                                                            <input type="hidden" name="title" value="{{ survey.title }}">
                                                            <input type="hidden" name="description"
                                                                value="{{ survey.description }}">
                                                            <a style="cursor: pointer" class="dropdown-item"
                                                                onclick="this.closest('form').submit();return false;">Share
                                                                to <i class="fab fa-whatsapp fa-lg"></i></a>
                                                        </form>

                                                        <form method="POST" action="{% url 'twitter_api' %}"
                                                            target="_blank">
                                                            {% csrf_token %}
                                                            <input type="hidden" name="survey_link"
                                                                value="{{ survey.link }}">
                                                            <input type="hidden" name="title" value="{{ survey.title }}">
                                                            <input type="hidden" name="description"
                                                                value="{{ survey.description }}">
                                                            <a style="cursor: pointer" class="dropdown-item"
                                                                onclick="this.closest('form').submit();return false;">Share
                                                                to <i class="fab fa-twitter"></i></a>
                                                        </form>

                                                        {% for desc in description_filtered %}
                                                        {% if survey.id == desc.id %}
                                                        <a class="dropdown-item"
                                                            href="
                                                            mailto:student_info-list@siswa.um.edu.my,fsktm_student-list@um.edu.my?subject={{ survey.title }}&body={{ desc.description }}%0D%0A%0ALink: {{ survey.link }}">Share
                                                            to
                                                            <i class="far fa-envelope fa-lg"></i></a>
                                                        {% endif %}
                                                        {% endfor %}
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                    </div>

                                    <div id="collapse{{ survey.id }}" class="collapse"
                                        aria-labelledby="heading{{ survey.id }}" data-parent="#accordion-{{ course.code }}">
                                        <div class="card-body" id="survey-description-main">
                                            <div class="form-row">
                                                <div class="form-group col-md-6">
                                                    <label>PIC Name</label>
                                                    <input type="text" class="form-control PIC_name"
                                                        value="{{ survey.PIC_name }}" style="background-color: white; color: #212529;"
                                                        disabled>
                                                </div>
                                                <div class="form-group col-md-6">
                                                    <label>PIC Email</label>
                                                    <input type="text" class="form-control" value="{{ survey.PIC_email }}"
                                                        style="background-color: white; color: #212529;" disabled>
                                                </div>
                                            </div>

                                            <label>Description</label>
                                            <textarea class="summernote" name="description" rows="7"
                                                placeholder="Enter description" required
                                                readonly>{{ survey.description }}</textarea>
                                            <!-- {{ survey.description }} -->
                                        </div>
                                    </div>
                                </div>
                                {% endif %}
                                {% endfor %}

                            </div>
                        </div>
                        {% endif %}
                        {% endfor %}

                        <!-- <div class="tab-pane fade" id="y2-c2">This is the content for subtab 2.2.</div>
                        <div class="tab-pane fade" id="y2-c3">This is the content for subtab 2.3.</div> -->
                    </div>
                </div>

                <div class="tab-pane fade" id="y3" role="tabpanel" aria-labelledby="y3-tab">
                    <h5>Here are the list of surveys for Year 3 faculty courses:</h5>

                    <ul class="nav nav-tabs">
                        {% for course in y3_course_list %}
                        {% if course.year.year == 3 and forloop.first %}
                        <li class="nav-item" data-toggle="tooltip" data-placement="top" title="{{ course.name }}">
                            <a class="nav-link active" data-toggle="tab" href="#y3-{{ course.code }}">{{ course.code }}</a>
                        </li>
                        {% elif course.year.year == 3 %}
                        <li class="nav-item" data-toggle="tooltip" data-placement="top" title="{{ course.name }}">
                            <a class="nav-link" data-toggle="tab" href="#y3-{{ course.code }}">{{ course.code }}</a>
                        </li>
                        {% endif %}
                        {% endfor %}
                    </ul>

                    <div class="tab-content" style="margin-bottom:50px">
                        {% for course in y3_course_list %}
                        {% if forloop.first %}
                        <div class="tab-pane fade show active" id="y3-{{ course.code }}">
                            <br>
                            <h5>{{ course.name }}</h5>
                            <br>

                            <!-- Search form -->
                            <div class="form-group">
                                <div class="row">
                                    <div class="col-md-4">
                                        <input class="form-control accordion_search_bar" id="{{ course.code }}"
                                            type="search" placeholder="Search title, description or PIC name"
                                            aria-label="Search">
                                    </div>
                                    <div class="col"></div>
                                </div>
                            </div>

                            <div id="accordion-{{ course.code }}" class="accordion">

                                {% for survey in survey_list %}
                                {% if survey.year.year == 3 and survey.course_code.code == course.code and survey.approved == True and survey.expiry_date != current_date %}
                                <div class="card {{ course.code }}" id="{{ survey.id }}">
                                    <div class="card-header">
                                        <div class="row justify-content-between">
                                            <div class="col-md-6">
                                                <h6 class="mb-0" style="cursor: pointer;" data-toggle="collapse"
                                                    data-target="#collapse{{ survey.id }}" aria-expanded="true"
                                                    aria-controls="collapse{{ survey.id }}">

                                                    <span class="survey_title">{{ survey.title }}</span>
                                                    <small class="form-text text-muted">Due on
                                                        {{ survey.expiry_date }}</small>

                                                </h6>
                                            </div>

                                            <div class="col-auto my-auto">
                                                <a target="_blank" href="{{ survey.link }}">Survey Link</a>
                                            </div>
                                            <div class="col-auto my-auto">
                                                <div class="dropdown">
                                                    <a role="button" id="dropdownMenuLink" data-toggle="dropdown"
                                                        aria-haspopup="true" aria-expanded="false">
                                                        <i class="fas fa-ellipsis-h"></i>
                                                    </a>
                                                    <div class="dropdown-menu justify-content-center"
                                                        aria-labelledby="dropdownMenuLink">
                                                        <form method="POST" action="{% url 'whatsapp_api' %}"
                                                            target="_blank">
                                                            {% csrf_token %}
                                                            <input type="hidden" name="survey_link"
                                                                value="{{ survey.link }}">
                                                            <input type="hidden" name="title" value="{{ survey.title }}">
                                                            <input type="hidden" name="description"
                                                                value="{{ survey.description }}">
                                                            <a style="cursor: pointer" class="dropdown-item"
                                                                onclick="this.closest('form').submit();return false;">Share
                                                                to <i class="fab fa-whatsapp fa-lg"></i></a>
                                                        </form>

                                                        <form method="POST" action="{% url 'twitter_api' %}"
                                                            target="_blank">
                                                            {% csrf_token %}
                                                            <input type="hidden" name="survey_link"
                                                                value="{{ survey.link }}">
                                                            <input type="hidden" name="title" value="{{ survey.title }}">
                                                            <input type="hidden" name="description"
                                                                value="{{ survey.description }}">
                                                            <a style="cursor: pointer" class="dropdown-item"
                                                                onclick="this.closest('form').submit();return false;">Share
                                                                to <i class="fab fa-twitter"></i></a>
                                                        </form>

                                                        {% for desc in description_filtered %}
                                                        {% if survey.id == desc.id %}
                                                        <a class="dropdown-item"
                                                            href="
                                                            mailto:student_info-list@siswa.um.edu.my,fsktm_student-list@um.edu.my?subject={{ survey.title }}&body={{ desc.description }}%0D%0A%0ALink: {{ survey.link }}">Share
                                                            to
                                                            <i class="far fa-envelope fa-lg"></i></a>
                                                        {% endif %}
                                                        {% endfor %}
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                    </div>

                                    <div id="collapse{{ survey.id }}" class="collapse"
                                        aria-labelledby="heading{{ survey.id }}" data-parent="#accordion-{{ course.code }}">
                                        <div class="card-body" id="survey-description-main">
                                            <div class="form-row">
                                                <div class="form-group col-md-6">
                                                    <label>PIC Name</label>
                                                    <input type="text" class="form-control PIC_name"
                                                        value="{{ survey.PIC_name }}" style="background-color: white; color: #212529;"
                                                        disabled>
                                                </div>
                                                <div class="form-group col-md-6">
                                                    <label>PIC Email</label>
                                                    <input type="text" class="form-control" value="{{ survey.PIC_email }}"
                                                        style="background-color: white; color: #212529;" disabled>
                                                </div>
                                            </div>

                                            <label>Description</label>
                                            <textarea class="summernote" name="description" rows="7"
                                                placeholder="Enter description" required
                                                readonly>{{ survey.description }}</textarea>
                                            <!-- {{ survey.description }} -->
                                        </div>
                                    </div>
                                </div>
                                {% endif %}
                                {% endfor %}

                            </div>
                        </div>
                        {% else %}
                        <div class="tab-pane fade" id="y3-{{ course.code }}">
                            <br>
                            <h5>{{ course.name }}</h5>
                            <br>

                            <!-- Search form -->
                            <div class="form-group">
                                <div class="row">
                                    <div class="col-md-4">
                                        <input class="form-control accordion_search_bar" id="{{ course.code }}"
                                            type="search" placeholder="Search title, description or PIC name"
                                            aria-label="Search">
                                    </div>
                                    <div class="col"></div>
                                </div>
                            </div>

                            <div id="accordion-{{ course.code }}" class="accordion">

                                {% for survey in survey_list %}
                                {% if survey.year.year == 3 and survey.course_code.code == course.code and survey.approved == True and survey.expiry_date != current_date %}
                                <div class="card {{ course.code }}" id="{{ survey.id }}">
                                    <div class="card-header">
                                        <div class="row justify-content-between">
                                            <div class="col-md-6">
                                                <h6 class="mb-0" style="cursor: pointer;" data-toggle="collapse"
                                                    data-target="#collapse{{ survey.id }}" aria-expanded="true"
                                                    aria-controls="collapse{{ survey.id }}">

                                                    <span class="survey_title">{{ survey.title }}</span>
                                                    <small class="form-text text-muted">Due on
                                                        {{ survey.expiry_date }}</small>

                                                </h6>
                                            </div>

                                            <div class="col-auto my-auto">
                                                <a target="_blank" href="{{ survey.link }}">Survey Link</a>
                                            </div>
                                            <div class="col-auto my-auto">
                                                <div class="dropdown">
                                                    <a role="button" id="dropdownMenuLink" data-toggle="dropdown"
                                                        aria-haspopup="true" aria-expanded="false">
                                                        <i class="fas fa-ellipsis-h"></i>
                                                    </a>
                                                    <div class="dropdown-menu justify-content-center"
                                                        aria-labelledby="dropdownMenuLink">
                                                        <form method="POST" action="{% url 'whatsapp_api' %}"
                                                            target="_blank">
                                                            {% csrf_token %}
                                                            <input type="hidden" name="survey_link"
                                                                value="{{ survey.link }}">
                                                            <input type="hidden" name="title" value="{{ survey.title }}">
                                                            <input type="hidden" name="description"
                                                                value="{{ survey.description }}">
                                                            <a style="cursor: pointer" class="dropdown-item"
                                                                onclick="this.closest('form').submit();return false;">Share
                                                                to <i class="fab fa-whatsapp fa-lg"></i></a>
                                                        </form>

                                                        <form method="POST" action="{% url 'twitter_api' %}"
                                                            target="_blank">
                                                            {% csrf_token %}
                                                            <input type="hidden" name="survey_link"
                                                                value="{{ survey.link }}">
                                                            <input type="hidden" name="title" value="{{ survey.title }}">
                                                            <input type="hidden" name="description"
                                                                value="{{ survey.description }}">
                                                            <a style="cursor: pointer" class="dropdown-item"
                                                                onclick="this.closest('form').submit();return false;">Share
                                                                to <i class="fab fa-twitter"></i></a>
                                                        </form>

                                                        {% for desc in description_filtered %}
                                                        {% if survey.id == desc.id %}
                                                        <a class="dropdown-item"
                                                            href="
                                                            mailto:student_info-list@siswa.um.edu.my,fsktm_student-list@um.edu.my?subject={{ survey.title }}&body={{ desc.description }}%0D%0A%0ALink: {{ survey.link }}">Share
                                                            to
                                                            <i class="far fa-envelope fa-lg"></i></a>
                                                        {% endif %}
                                                        {% endfor %}
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                    </div>

                                    <div id="collapse{{ survey.id }}" class="collapse"
                                        aria-labelledby="heading{{ survey.id }}" data-parent="#accordion-{{ course.code }}">
                                        <div class="card-body" id="survey-description-main">
                                            <div class="form-row">
                                                <div class="form-group col-md-6">
                                                    <label>PIC Name</label>
                                                    <input type="text" class="form-control PIC_name"
                                                        value="{{ survey.PIC_name }}" style="background-color: white; color: #212529;"
                                                        disabled>
                                                </div>
                                                <div class="form-group col-md-6">
                                                    <label>PIC Email</label>
                                                    <input type="text" class="form-control" value="{{ survey.PIC_email }}"
                                                        style="background-color: white; color: #212529;" disabled>
                                                </div>
                                            </div>

                                            <label>Description</label>
                                            <textarea class="summernote" name="description" rows="7"
                                                placeholder="Enter description" required
                                                readonly>{{ survey.description }}</textarea>
                                            <!-- {{ survey.description }} -->
                                        </div>
                                    </div>
                                </div>
                                {% endif %}
                                {% endfor %}

                            </div>
                        </div>
                        {% endif %}
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
    </div>


</div>

<div class="modal fade" id="survey-form" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle"
    aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLongTitle">Survey Form Application</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <form method="POST" id="survey-form-container" action="{% url 'home' %}" class="needs-validation"
                novalidate>
                {% csrf_token %}
                <div class="modal-body">

                    <div class="form-group">
                        <label>Title<span style="color: red">&nbsp;*</span></label>
                        <input name="title" type="text" class="form-control" placeholder="Enter title"
                            required="required">
                        <!-- <small class="form-text text-muted">We'll never share your email with anyone else.</small> -->
                        <div class="invalid-feedback">Please enter a survey title.</div>
                    </div>

                    <div class="form-group" id="survey-description">
                        <label>Description<span style="color: red">&nbsp;*</span></label>
                        <!-- <textarea name="description" class="form-control" placeholder="Enter description"
                            style="max-height: 20rem; min-height: 5rem;" required="required"></textarea> -->
                        <textarea id="summernote" name="description" rows="7" placeholder="Enter description"
                            required></textarea>
                        <small class="form-text text-muted">Recommended to include a short description of your
                            survey.</small>
                        <div class="invalid-feedback">Please enter a survey description.</div>
                    </div>

                    <div class="form-group">
                        <label>Year<span style="color: red">&nbsp;*</span></label>
                        <select name="year" id="year" class="selectpicker form-control" required="required">
                            <option value="" selected style="display: none">Not set</option>
                            <!-- <option value="1">Year 1</option>
                            <option value="2">Year 2</option>
                            <option value="3">Year 3</option> -->

                            {% for year in year_list %}
                            <option value="{{ year.year }}">
                                {{ year.label }}</option>
                            {% endfor %}

                        </select>
                        <div class="invalid-feedback">Please select a year.</div>
                    </div>

                    <div class="form-group">
                        <label>Course Code<span style="color: red">&nbsp;*</span></label>
                        <select name="course_code" id="course-code" class="selectpicker form-control"
                            required="required">
                            <option value="" selected style="display: none">Not set</option>

                            {% for course_code in course_list %}
                            <option selected type="{{ course_code.year.year }}" value="{{ course_code.code }}">
                                {{ course_code.code }} ({{ course_code.name }})</option>
                            {% endfor %}

                        </select>
                        <div class="invalid-feedback">Please select a course code.</div>
                    </div>

                    <div class="form-group">
                        <label>Survey link<span style="color: red">&nbsp;*</span></label>
                        <input name="link" type="text" class="form-control" placeholder="Enter link"
                            required="required">
                        <!-- <small class="form-text text-muted">We'll never share your email with anyone else.</small> -->
                        <div class="invalid-feedback">Please enter the survey link.</div>
                    </div>

                    <div class="form-group">
                        <label>Person In Charge (PIC) Name<span style="color: red">&nbsp;*</span></label>
                        <input name="PIC_name" type="text" class="form-control" placeholder="Enter PIC name"
                            required="required">
                        <!-- <small class="form-text text-muted">We'll never share your email with anyone else.</small> -->
                        <div class="invalid-feedback">Please enter the survey PIC/representative's name.</div>

                    </div>

                    <div class="form-group">
                        <label>Person In Charge (PIC) Email<span style="color: red">&nbsp;*</span></label>
                        <input name="PIC_email" type="email" class="form-control" placeholder="Enter PIC email"
                            required="required">
                        <!-- <small class="form-text text-muted">We'll never share your email with anyone else.</small> -->
                        <div class="invalid-feedback">Please enter a valid survey PIC/representative's email.</div>
                    </div>

                    <div class="form-group">
                        <label>Expiry Date</label>
                        <input name="expiry_date" id="expiry-date" type="date" class="form-control">
                        <small class="form-text text-muted">If not selected, default expiry date for survey form is 1
                            month from date of application.</small>
                        <!-- <div class="invalid-feedback">Please enter the survey PIC/representative's email.</div> -->
                    </div>

                    <div class="alert alert-primary" role="alert">
                        <small class="form-text">
                            By submitting this survey application, you hereby:
                            <br><br>
                            1. <b>Declare</b> that the information provided is <b>true
                                and correct</b>, and;
                            <br><br>
                            2. <b>Agree</b> that the information given <b>can be shared publicly</b> in this domain.
                            <br><br>
                            Please take note that your survey form will <b>only appear on the web app</b> after
                            <b>approval</b> from the
                            administrator.</small>
                    </div>

                    <!-- <div class="alert alert-dark" role="alert">
                        Please take note that your survey form will only appear on the web app after approval from the
                        administrator.
                    </div> -->
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    <button type="submit" class="btn btn-primary">Send</button>
                </div>
            </form>

        </div>
    </div>
</div>
<script type="text/javascript" src="{% static 'js/home.js' %}"></script>
<script>
    // Example starter JavaScript for disabling form submissions if there are invalid fields
    (function () {
        'use strict';
        window.addEventListener('load', function () {
            // Fetch all the forms we want to apply custom Bootstrap validation styles to
            var forms = document.getElementsByClassName('needs-validation');
            // Loop over them and prevent submission
            var validation = Array.prototype.filter.call(forms, function (form) {
                form.addEventListener('submit', function (event) {
                    if (form.checkValidity() === false) {
                        event.preventDefault();
                        event.stopPropagation();
                    }
                    form.classList.add('was-validated');
                }, false);
            });
        }, false);
    })();
</script>
{% endblock %}